#!/usr/bin/env ruby
# frozen_string_literal: true

$LOAD_PATH.unshift File.join(File.dirname(__FILE__), '..', 'lib')

require 'array_database'
require 'controler'
require 'creator'
require 'file_database'
require 'finder'
require 'io/console'
require 'language_parser'
require 'null_action'
require 'pager'
require 'pathname'
require 'terminator'
require 'updater'
require 'user_interface'
require 'validator'

messages_object = LanguageParser.new(Pathname.new('en.yml')).messages

file = File.new('contacts.json', 'r+')
file_database = FileDatabase.new(file)

user_interface = UserInterface.new($stdin, $stdout, Validator.new(messages_object), messages_object)
actions = [
  Pager.new(user_interface, file_database),
  Creator.new(user_interface, file_database),
  Finder.new(user_interface, file_database),
  Updater.new(user_interface, file_database),
  Terminator.new(user_interface, file_database),
  NullAction.new
]

Controler.new(user_interface, actions, messages_object).start
file.close
